testName=mpfss_batch_codes

OBLIVCC=../../obliv-c/bin/oblivcc
RUNTIME=../../obliv-c/_build/libobliv.a


#DNDEBUG sets the debug level. 
CFLAGS=-g -Wall -D _Float128=double -DDEBUG

ACKLIB_FFSL=../../absentminded-crypto-kit/src/oram_fssl/
Mpfss_path=../mpfss/
Util_path=../util/
include_path=include/
bcrandom_paht=../../obliv-c/src/ext/oblivc/
INCLUDE=-I$(ACKLIB_FFSL) -I$(Mpfss_path) -I$(Util_path) -I$(bcrandom_paht) -I$(include_path)

c_files := $(include/*.c)
oc_files := $(include/*.oc)

LOADFILES= $(c_files) $(oc_files) ../mpfss/mpfss_naive.oc

ACKLIB_PATH=../../absentminded-crypto-kit/build/lib/liback.a 
#-lgomp flag is very important. Otherwise linking will fail. Does some kind of parallelization.
LOADLIBES=-fopenmp $(ACKLIB_PATH) -lm


./a.out: $(testName).c $(RUNTIME)
	$(OBLIVCC) $(CFLAGS) $(INCLUDE) $(testName).c $(testName).oc $(LOADFILES) $(LOADLIBES) 


clean:
	rm -f a.out 

